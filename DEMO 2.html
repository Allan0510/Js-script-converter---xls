<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Excel to JS Object Converter</title>

<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

<style>
*{margin:0;padding:0;box-sizing:border-box}
body{
    font-family:Segoe UI,Tahoma,Verdana,sans-serif;
    background:linear-gradient(135deg,#0f0c29,#302b63,#24243e);
    min-height:100vh;
    padding:30px;
}
.container{max-width:1200px;margin:auto}
h1{text-align:center;color:#fff;margin-bottom:10px;font-size:2.4rem}
.subtitle{text-align:center;color:#bbb;margin-bottom:30px}

.upload-section,.output-section{
    background:#fff;
    padding:30px;
    border-radius:20px;
    box-shadow:0 15px 40px rgba(0,0,0,.3);
    margin-bottom:25px;
}

.upload-area{
    border:3px dashed #4a90d9;
    border-radius:15px;
    padding:50px;
    text-align:center;
    cursor:pointer;
    background:#f8fafc;
}
.upload-area.dragover{background:#e0f2fe;border-color:#22c55e}

#fileInput{display:none}

.format-options{
    background:#f1f5f9;
    padding:20px;
    border-radius:12px;
    margin-top:20px;
}
.format-grid{
    display:grid;
    grid-template-columns:repeat(auto-fit,minmax(220px,1fr));
    gap:15px;
}
.format-item input{
    width:160px;
    padding:8px;
    border:2px solid #ddd;
    border-radius:6px;
}
.format-item

textarea{
    width:100%;
    height:500px;
    background:#1e1e1e;
    color:#d4d4d4;
    font-family:Consolas,monospace;
    font-size:13px;
    padding:20px;
    border-radius:10px;
}

.button-group{text-align:center;margin-top:20px}
button{
    padding:12px 30px;
    margin:5px;
    border:none;
    border-radius:10px;
    cursor:pointer;
    font-weight:600;
}
.btn-success{background:#22c55e;color:#fff}
.btn-primary{background:#2563eb;color:#fff}
.btn-secondary{background:#6b7280;color:#fff}

.output-header{
    background:#1e293b;
    color:#fff;
    padding:auto;
    border-radius:12px 12px 0 0;
    display:flex;
    justify-content:space-between;
}
.stat-value{color:#4ade80;font-weight:700}
</style>
</head>

<body>
<div class="container">

<h1>üìä Excel to JS Object Converter</h1>
<p class="subtitle">Now supports Time Zone mapping</p>

<div class="upload-section">
    <div class="upload-area" id="dropZone" onclick="fileInput.click()">
        <h3>üìÅ Click or Drag Excel File</h3>
    </div>
    <input type="file" id="fileInput" accept=".xlsx,.xls" onchange="handleFile(event)">

    <div class="format-options">
        <h3>‚öôÔ∏è Column Mapping</h3>
        <div class="format-grid">
            <div class="format-item">
                <label>Syscode</label><br>
                <input id="colSyscode" value="">
            </div>
            <div class="format-item">
                <label>Region</label><br>
                <input id="colRegion" value="">
            </div>
            <div class="format-item">
                <label>SET Area</label><br>
                <input id="colSetArea" value="">
            </div>
            <div class="format-item">
                <label>Zone Type</label><br>
                <input id="colZoneType" value="">
            </div>
            <div class="format-item">
                <label>Time Zone</label><br>
                <input id="colTimeZone" value="">
            </div>
            <div class="format-item">
                <label>XG</label><br>
                <input id="colXG" value="">
            </div>
        </div>
    </div>
</div>

<div class="output-section">
    <div class="output-header">
        <div>üìù Generated JS Code</div>
        <div>
            Rows: <span class="stat-value" id="rowCount">0</span> |
            Characters: <span class="stat-value" id="charCount">0</span>
        </div>
    </div>

    <textarea id="output" readonly></textarea>

    <div class="button-group">
        <button class="btn-success" onclick="copyToClipboard()">üìã Copy</button>
        <button class="btn-primary" onclick="downloadAsJS()">üíæ Download</button>
        <button class="btn-secondary" onclick="clearOutput()">üóëÔ∏è Clear</button>
    </div>
</div>

</div>

<script>
let parsedData=[];

const dropZone=document.getElementById("dropZone");
dropZone.addEventListener("dragover",e=>{e.preventDefault();dropZone.classList.add("dragover")});
dropZone.addEventListener("dragleave",()=>dropZone.classList.remove("dragover"));
dropZone.addEventListener("drop",e=>{
    e.preventDefault();
    dropZone.classList.remove("dragover");
    processFile(e.dataTransfer.files[0]);
});

function handleFile(e){processFile(e.target.files[0]);}

function processFile(file){
    const reader=new FileReader();
    reader.onload=e=>{
        const wb=XLSX.read(new Uint8Array(e.target.result),{type:"array"});
        const ws=wb.Sheets[wb.SheetNames[0]];
        parsedData=XLSX.utils.sheet_to_json(ws,{defval:""});
        autoDetect(Object.keys(parsedData[0]||{}));
        convertToJS();
    };
    reader.readAsArrayBuffer(file);
}

function autoDetect(headers){
    headers.forEach(h=>{
        const l=h.toLowerCase();
        if(l.includes("sys")) colSyscode.value=h;
        if(l.includes("region")) colRegion.value=h;
        if(l.includes("set")||l.includes("area")) colSetArea.value=h;
        if(l.includes("zone type")) colZoneType.value=h;
        if(l.includes("time")) colTimeZone.value=h;
        if(l.includes("xg")) colXG.value=h;
    });
}


function convertToJS(){
    if(!parsedData.length) return;

    let out="const syscodeData = [\n";
    let count=0;

    parsedData.forEach((r,i)=>{
        if(!r[colSyscode.value]) return;
        count++;
        out+=`{syscode: "${r[colSyscode.value]}", region: "${r[colRegion.value]}", setArea: "${r[colSetArea.value]}", zoneType: "${r[colZoneType.value]}",XG: "${r[colXG.value]}", timeZone: "${r[colTimeZone.value]}"}${i<parsedData.length-1?",":""}\n`;
    });

    out+="];";
    output.value=out;
    rowCount.textContent=count;
    charCount.textContent=out.length;
}

function copyToClipboard(){
    navigator.clipboard.writeText(output.value);
}

function downloadAsJS(){
    const blob=new Blob([output.value],{type:"text/javascript"});
    const a=document.createElement("a");
    a.href=URL.createObjectURL(blob);
    a.download="syscodeData.js";
    a.click();
}

function clearOutput(){
    output.value="";
    rowCount.textContent=0;
    charCount.textContent=0;
    parsedData=[];
}

document.querySelectorAll("input").forEach(i=>i.addEventListener("change",convertToJS));
</script>
</body>
</html>

